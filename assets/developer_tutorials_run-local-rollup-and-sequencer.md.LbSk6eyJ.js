import{_ as s,c as a,o as i,a5 as t}from"./chunks/framework.-Zveb6AF.js";const e="/assets/dusk-10-go-cli-local-sequencer.jzKUDCBW.png",y=JSON.parse('{"title":"Run a Local Rollup and Sequencer","description":"","frontmatter":{},"headers":[],"relativePath":"developer/tutorials/run-local-rollup-and-sequencer.md","filePath":"developer/tutorials/run-local-rollup-and-sequencer.md","lastUpdated":1724887298000}'),n={name:"developer/tutorials/run-local-rollup-and-sequencer.md"},l=t(`<h1 id="run-a-local-rollup-and-sequencer" tabindex="-1">Run a Local Rollup and Sequencer <a class="header-anchor" href="#run-a-local-rollup-and-sequencer" aria-label="Permalink to &quot;Run a Local Rollup and Sequencer&quot;">​</a></h1><p>This guide will walk you through running a local Geth rollup against the Astria sequencer, using the <code>astria-go</code> cli to run the required components of the Astria stack locally on your machine.</p><h2 id="setup-a-geth-rollup" tabindex="-1">Setup a Geth Rollup <a class="header-anchor" href="#setup-a-geth-rollup" aria-label="Permalink to &quot;Setup a Geth Rollup&quot;">​</a></h2><p>Requires <code>Go</code>, <code>just</code>, and <code>Foundry</code>:</p><ul><li><a href="https://go.dev/doc/install" target="_blank" rel="noreferrer">Go</a></li><li><a href="https://github.com/casey/just" target="_blank" rel="noreferrer">just</a></li><li><a href="https://book.getfoundry.sh/getting-started/installation" target="_blank" rel="noreferrer">Foundry</a></li></ul><p>Open a new terminal window and clone and build Geth:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-OX2F5" id="tab-ipZI2mZ" checked="checked"><label for="tab-ipZI2mZ">SSH</label><input type="radio" name="group-OX2F5" id="tab-Dy18Kle"><label for="tab-Dy18Kle">HTTPS</label></div><div class="blocks"><div class="language-bash vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git@github.com:astriaorg/astria-geth.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> astria-geth</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local-dev</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clean</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/astriaorg/astria-geth.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> astria-geth</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local-dev</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clean</span></span></code></pre></div></div></div><p>Create a new genesis account for your Geth rollup:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cast</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span></span></code></pre></div><p>Open the <code>geth-genesis-local.json</code> file in your Geth repo and update the <code>&quot;alloc&quot;</code> account with the new address you just created, as well as updating the <code>&quot;chainId&quot;</code> and <code>&quot;astriaRollupName&quot;</code> to something of your choosing:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;config&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;chainId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> digit</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> number&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;astriaRollupName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;your rollup name&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;alloc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;&lt;your new address&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;balance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;300000000000000000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>You will use the private key for your new account to send <a href="./test-transactions">test transactions</a> later on.</p><h2 id="start-geth" tabindex="-1">Start Geth <a class="header-anchor" href="#start-geth" aria-label="Permalink to &quot;Start Geth&quot;">​</a></h2><p>In your Geth terminal window, run the following to initialize and run the Geth rollup:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># in astria-geth dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre></div><p>If you need to restart the rollup, you can stop the program with <code>Ctrl+C</code> and restart with:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre></div><p>If you need to restart the rollup and want to also clear the state data, you can use:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">just</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clean-restart</span></span></code></pre></div><h2 id="configure-and-start-the-local-astria-sequencer" tabindex="-1">Configure and Start the Local Astria Sequencer <a class="header-anchor" href="#configure-and-start-the-local-astria-sequencer" aria-label="Permalink to &quot;Configure and Start the Local Astria Sequencer&quot;">​</a></h2><p>Open a new terminal window and initialize the cli:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">astria-go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span></code></pre></div><p>Navigate to the <code>~/.astria</code> directory. If you have run the commands shown above, you should find a <code>default</code> directory.</p><p>Open the <code>~/.astria/default/networks-config.toml</code> file and update the <code>rollup_name</code> variable in the <code>[local]</code> sections using the same <code>&quot;astriaRollupName&quot;</code> you used when <a href="#setup-a-geth-rollup">setting up your Geth rollup</a>.</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">networks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequencer_chain_id = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sequencer-test-chain-0&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequencer_grpc = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://127.0.0.1:8080&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequencer_rpc = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://127.0.0.1:26657&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rollup_name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;your rollup name&gt;&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # update this value</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">default_denom = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nria&#39;</span></span></code></pre></div><p>Use the cli to run a local Astria Sequencer.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">astria-go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>When running an Astria sequencer using the cli, the <code>--network local</code> setting is the default. <code>astria-go dev run</code> is effectively an alias for <code>astria-go dev run --network local</code>.</p></div><p>When running the Astria stack locally, you will see a TUI that displays the logs of the Astria Sequencer, the underlying Cometbft node, the Astria Conductor, and Astria Composer: <img src="`+e+`" alt="Running a local sequencer in the Astria
cli"></p><h2 id="test-your-rollup" tabindex="-1">Test your Rollup <a class="header-anchor" href="#test-your-rollup" aria-label="Permalink to &quot;Test your Rollup&quot;">​</a></h2><p>To test that your rollup and the sequencer are configured and running correctly, you can follow the <a href="./test-transactions">Test Transactions instructions here</a>.</p>`,31),h=[l];function p(o,r,d,k,c,u){return i(),a("div",null,h)}const F=s(n,[["render",p]]);export{y as __pageData,F as default};
